<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <meta property="og:url" content="http://the-javascripting-english-major.org/v1/9-dataset" />
    <meta property="og:type" content="website" />
    
      <meta property="og:title" content="Building a Dataset | The JavaScripting English Major" />
      <title>Building a Dataset | The JavaScripting English Major</title>
      <meta name="twitter:title" content="Building a Dataset | The JavaScripting English Major" />
    
    <meta name="DC.title" content="The JavaScripting English Major" />
    <meta name="DC.creator" content="Sá Pereira, Moacir P." />
    <meta name="DC.description" content="A 15-session course that teaches humanities undergraduates how to write their own web-based project using JavaScript." />
    <meta name="DC.type" content="Text">
    <meta name="DC.created" content="2017-07-25">
    <meta name="DC.date" content="2017-07-25">
    <meta property="og:site_name" content="The JavaScripting English Major" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="website" />
    <meta property="og:description" content="A 15-session course that teaches humanities undergraduates how to write their own web-based project using JavaScript." />
    <meta property="description" content="A 15-session course that teaches humanities undergraduates how to write their own web-based project using JavaScript." />
    <meta property="og:image" content="http://i.imgur.com/7FNZU7I.jpg" />
    <meta property="og:image:type" content="image/jpeg" />
    <meta property="og:image:height" content="285" />
    <meta property="og:image:width" content="535" />
    <meta property="og:url" content="https://the-javascripting-english-major.org/v1/9-dataset" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@JSingEnglishMaj" />
    <meta name="twitter:creator" content="@muziejus" />
    <meta name="twitter:description" content="A 15-session course that teaches humanities undergraduates how to write their own web-based project using JavaScript." />
    <meta name="twitter:image" content="http://i.imgur.com/Sh7MOqg.jpg" />
    <link rel="canonical" href="https://the-javascripting-english-major.org/v1/9-dataset" />
    <link rel="apple-touch-icon" sizes="180x180" href="/v1/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/v1/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/v1/favicon-16x16.png">
    <link rel="manifest" href="/v1/manifest.json">
    <link rel="mask-icon" href="/v1/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="theme-color" content="#ffffff">
    <script type="application/ld+json">
    {"name":null,"description":"A 15-session course that teaches humanities undergraduates how to write their own web-based project using JavaScript.","author":null,"@type":"WebPage","url":"https://the-javascripting-english-major.org/v1/9-dataset","image":null,"publisher":null,"headline":"The JavaScripting English Major","dateModified":null,"datePublished":null,"sameAs":null,"mainEntityOfPage":null,"@context":"http://schema.org"}</script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" href="/v1/assets/css/style.css?v=4d7e5e7dced98209cd960e9bf09167782dc05716">
  </head>

  <body>
    <nav id="topNav" class="navbar navbar-toggleable-md fixed-top navbar-light bg-base2">
  <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <a class="navbar-brand" href="/v1/contents">
    <img class="brand-img" alt=".js" src="/v1/assets/images/logo-no-border-sq.svg" width="35">
    <span id="brand-name-small">The .JSing English Major</span>
    <span id="brand-name-big">The JavaScripting English Major</span>
  </a>
  <div class="collapse navbar-collapse" id="navbar">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" id="chapters" aria-expanded="false" aria-haspopup="true" data-toggle="dropdown" href="#">
          Chapters
        </a>
        <div class="dropdown-menu" aria-labelledby="chapters">
          <a class="dropdown-item" href="/v1/0-introduction">0. Introduction</a>
          <a class="dropdown-item" href="/v1/1-environment">1. Environment</a>
          <a class="dropdown-item" href="/v1/2-calculator">2. JS Calculator</a>
          <a class="dropdown-item" href="/v1/3-programming">3. Programming</a>
          <a class="dropdown-item" href="/v1/4-functions">4. Functions</a>
          <a class="dropdown-item" href="/v1/5-collections">5. Collections</a>
          <a class="dropdown-item" href="/v1/6-abstraction">6. Abstraction</a>
          <a class="dropdown-item" href="/v1/7-errors">7. Oops!</a>
          <a class="dropdown-item" href="/v1/8-webpage">8. Webpage Writing</a>
          <a class="dropdown-item" href="/v1/9-dataset">9. Datasets</a>
          <a class="dropdown-item" href="/v1/10-leaflet">10. Leaflet</a>
          <a class="dropdown-item" href="/v1/11-geojson">11. Starting a Project</a>
          <a class="dropdown-item" href="/v1/12-markdown">12. Markdown</a>
          <a class="dropdown-item" href="/v1/13-bootstrap">13. Layout and Content</a>
          <a class="dropdown-item" href="/v1/14-events-popups">14. Events and Popups</a>
          <a class="dropdown-item" href="/v1/15-go-live">15. Going Live</a>
          <a class="dropdown-item" href="/v1/a-resources">A. Resources</a>
        </div>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" id="help" aria-expanded="false" aria-haspopup="true" data-toggle="dropdown" href="#">
          Help
        </a>
        <div class="dropdown-menu" aria-labelledby="help">
          <a class="dropdown-item" href="/v1/help/map-to-version-2">Map to version 2</a>
          <a class="dropdown-item" href="/v1/help/js-cheat-sheet">JavaScript Cheat Sheet</a>
          <a class="dropdown-item" href="/v1/help/atom">Atom Help</a>
        </div>
      </li>
      <li class="nav-item">
        <a href="/v1/about" class="nav-link">About</a>
      </li>
    </ul>
  </div>
</nav>


    <div class="container">
      <div class="row">
        <aside class="col-md-4">
          <h1>Building a Dataset</h1>
          <hr>
          <center>
            <h2 class="fa fa-spinner"></h2>
          </center>
        </aside>
        <article class="col-md-8">
          <p>Your excitement should be growing as finally, you will stop making play pages
and actually build a self-contained digital version of a text you may already
know (or will see soon in your academic career), the <a href="https://en.wikipedia.org/wiki/General_Prologue">General
Prologue</a> of <em>The Canterbury
Tales</em>—or at least the first 18 lines. Here they are, in their late 14th
century Middle English grandeur:</p>

<blockquote>
  <p>Whan that Aprill, with his shoures soote<br />
  The droghte of March hath perced to the roote<br />
  And bathed every veyne in swich licour,<br />
  Of which vertu engendred is the flour;<br />
  Whan Zephirus eek with his sweete breeth<br />
  Inspired hath in every holt and heeth<br />
  The tendre croppes, and the yonge sonne<br />
  Hath in the Ram his halve cours yronne,<br />
  And smale foweles maken melodye,<br />
  That slepen al the nyght with open ye<br />
  (So priketh hem Nature in hir corages);<br />
  Thanne longen folk to goon on pilgrimages<br />
  And palmeres for to seken straunge strondes<br />
  To ferne halwes, kowthe in sondry londes;<br />
  And specially from every shires ende<br />
  Of Engelond to Caunterbury they wende,<br />
  The hooly blisful martir for to seke<br />
  That hem hath holpen, whan that they were seeke.</p>
</blockquote>

<p>In this chapter, you will create a webpage that glosses these first 18 lines.
That is, it prints them, and then it turns every word that might not be clear
into a link the user can click on. And when the user does click on such a
word, the modern version of that word appears in a box below the text.</p>

<section id="building-a-page">
  <h2 id="s-building-a-page-for-the-prologue">Building a page for the Prologue</h2>

  <p>First, you should make a link to the new page from your old page. Open up
<code class="highlighter-rouge">index.html</code> in Atom, and add this below the <code class="highlighter-rouge">&lt;h1&gt;</code> tag:</p>

  <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;h2&gt;&lt;a</span> <span class="na">href=</span><span class="s">"prologue.html"</span><span class="nt">&gt;</span>General Prologue<span class="nt">&lt;/a&gt;&lt;/h2&gt;</span>
</code></pre></div>  </div>

  <p>Now, create a new file in your project called <code class="highlighter-rouge">prologue.html</code> Paste into it
this basic structure:</p>

  <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"utf-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>General Prologue<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1, shrink-to-fit=no"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css"</span> <span class="na">integrity=</span><span class="s">"sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ"</span> <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"prologue.css"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h1&gt;</span>The General Prologue of <span class="nt">&lt;em&gt;</span>The Canterbury Tales<span class="nt">&lt;/em&gt;&lt;/h1&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"intro"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;p&gt;</span>Welcome to the first 18 lines of Chaucer’s “General 
          Prologue.” If you don’t recognize a word, just click 
          on it, and a gloss will appear below.
        <span class="nt">&lt;/p&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"prologue"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"glosses"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://code.jquery.com/jquery-3.2.1.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"</span> <span class="na">integrity=</span><span class="s">"sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb"</span> <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js"</span> <span class="na">integrity=</span><span class="s">"sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn"</span> <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"prologue.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div>  </div>

  <p>Note lines 8 and 26. They load not <code class="highlighter-rouge">styles.css</code> and <code class="highlighter-rouge">scripts.js</code>, but, rather,
<code class="highlighter-rouge">prologue.css</code> and <code class="highlighter-rouge">prologue.js</code>. If you want to create a <code class="highlighter-rouge">prologue.css</code> and
populate it with your favorite styles, go ahead. <code class="highlighter-rouge">prologue.js</code>, however, is
the focus of this chapter. So create a new file in Atom called <code class="highlighter-rouge">prologue.js</code>
and paste in these two jQuery commands that should already look rather
familiar to you:</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">(</span><span class="s2">"#prologue"</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s2">"&lt;p&gt;The text of the Prologue will go here.&lt;/p&gt;"</span><span class="p">);</span>
<span class="nx">$</span><span class="p">(</span><span class="s2">"#glosses"</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s2">"&lt;p&gt;The glosses will go here.&lt;/p&gt;"</span><span class="p">);</span>
</code></pre></div>  </div>

  <p>Save and load <code class="highlighter-rouge">prologue.html</code> in the browser. The text in the
jQuery commands should appear on <code class="highlighter-rouge">prologue.html</code>. If it does, commit.</p>

</section>
<section id="prologue-into-data">
  <h2 id="s-turning-the-prologue-into-data">Turning the Prologue into data</h2>

  <p>It could be possible to write an interactive version of the Prologue (that is,
with links) in HTML, but that would involve a lot of repetition. Programmers
hate repetition, so think for a moment about what the Prologue would look like
as a dataset in JavaScript. What are our two data types for collections of
information? Arrays and <code class="highlighter-rouge">Object</code>s. Are 18 lines of poetry more like an array or
an <code class="highlighter-rouge">Object</code>? Both would work, for different reasons, but an array will be
simplest.</p>

  <p>We can think of the first 18 lines as an array that is 18
elements long, with each element being its own line, something like:</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">prologueText</span><span class="p">,</span> <span class="nx">line1</span><span class="p">,</span> <span class="nx">line2</span><span class="p">,</span> <span class="nx">line3</span><span class="p">,</span> <span class="nx">line17</span><span class="p">,</span> <span class="nx">line18</span><span class="p">;</span>
<span class="nx">prologueText</span> <span class="o">=</span> <span class="p">[</span><span class="nx">line1</span><span class="p">,</span> <span class="nx">line2</span><span class="p">,</span> <span class="nx">line3</span><span class="p">,</span> <span class="nx">line17</span><span class="p">,</span> <span class="nx">line18</span><span class="p">];</span>
</code></pre></div>  </div>

  <p>Then each line could be an array of the words (defined as things between
spaces) in that line, so that:</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">line1</span><span class="p">;</span>
<span class="nx">line1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Whan"</span><span class="p">,</span> <span class="s2">"that"</span><span class="p">,</span> <span class="s2">"Aprill,"</span><span class="p">,</span> <span class="s2">"with"</span><span class="p">,</span> <span class="s2">"his"</span><span class="p">,</span> <span class="s2">"shoures"</span><span class="p">,</span> <span class="s2">"soote"</span><span class="p">];</span>
</code></pre></div>  </div>

  <p>In this way, <code class="highlighter-rouge">prologueText</code> would be an array of arrays. That sounds like a
good way to do things, but I don’t like the line array as a line of strings.
It would be better if it were an array of <code class="highlighter-rouge">Object</code>s, or word-<code class="highlighter-rouge">Object</code>s, like this:</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">line1</span><span class="p">;</span>
<span class="nx">line1</span> <span class="o">=</span> <span class="p">[{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"Whan"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"that"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"Aprill,"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"with"</span><span class="p">},</span>
        <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"his"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"shoures"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"soote"</span><span class="p">}];</span> 
</code></pre></div>  </div>

  <p>Now you can sort of imagine using the <code class="highlighter-rouge">.map()</code> method like this:</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">line1TextArray</span><span class="p">;</span>
<span class="nx">line1TextArray</span> <span class="o">=</span> <span class="nx">line1</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">word</span><span class="p">){</span>
  <span class="k">return</span> <span class="nx">word</span><span class="p">.</span><span class="nx">text</span><span class="p">;</span>
<span class="p">});</span>
</code></pre></div>  </div>

  <p>The <code class="highlighter-rouge">.map()</code> creates a new array out of the array of word-<code class="highlighter-rouge">Object</code>s, and this
new array is just the <code class="highlighter-rouge">.text</code> property of each <code class="highlighter-rouge">Object</code>, or, a string. Then we
use the <code class="highlighter-rouge">.join()</code> method on <code class="highlighter-rouge">line1TextArray</code> to turn the array into one single
string, separated by spaces. Put it all together in <code class="highlighter-rouge">prologue.js</code>, and:</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">(</span><span class="s2">"#glosses"</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s2">"&lt;p&gt;The glosses will go here.&lt;/p&gt;"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">line1</span><span class="p">,</span> <span class="nx">line1Text</span><span class="p">;</span> <span class="c1">// don’t need the intermediate step of line1TextArray</span>
<span class="nx">line1</span> <span class="o">=</span> <span class="p">[{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"Whan"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"that"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"Aprill,"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"with"</span><span class="p">},</span>
        <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"his"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"shoures"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"soote"</span><span class="p">}];</span>
<span class="nx">line1Text</span> <span class="o">=</span> <span class="nx">line1</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">word</span><span class="p">){</span>
  <span class="k">return</span> <span class="nx">word</span><span class="p">.</span><span class="nx">text</span><span class="p">;</span>
<span class="p">}).</span><span class="nx">join</span><span class="p">(</span><span class="s2">" "</span><span class="p">);</span>
<span class="nx">$</span><span class="p">(</span><span class="s2">"#prologue"</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s2">"&lt;p&gt;"</span> <span class="o">+</span> <span class="nx">line1Text</span> <span class="o">+</span> <span class="s2">"&lt;br /&gt;&lt;/p&gt;"</span><span class="p">);</span>
<span class="c1">// &lt;br /&gt; makes a line break, which will come in handy when we have many</span>
<span class="c1">// lines.</span>
</code></pre></div>  </div>

  <p>Type the above into <code class="highlighter-rouge">prologue.js</code>, save, and reload. Now the first line of the
Prologue should appear on the page. If it does, commit. Time to increase the
complexity. Are you ready?</p>

  <p>The Wikipedia page for the General Prologue provides a word-for-word
translation into Modern English. So let’s add a property, <code class="highlighter-rouge">.modern</code>, to each
word-<code class="highlighter-rouge">Object</code> that includes its modern version:</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">line1</span> <span class="o">=</span> <span class="p">[{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"Whan"</span><span class="p">,</span> <span class="na">modern</span><span class="p">:</span> <span class="s2">"When"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"that"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"Aprill,"</span><span class="p">,</span>
        <span class="na">modern</span><span class="p">:</span> <span class="s2">"April,"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"with"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"his"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"shoures"</span><span class="p">,</span>
        <span class="na">modern</span><span class="p">:</span> <span class="s2">"showers"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"soote"</span><span class="p">,</span> <span class="na">modern</span><span class="p">:</span> <span class="s2">"sweet"</span><span class="p">}];</span> 
</code></pre></div>  </div>

  <p>This way, we can access the <code class="highlighter-rouge">word.modern</code> property and send it, as a gloss, to
the <code class="highlighter-rouge">#glosses</code> entity at the bottom of the page. But that takes a little
ingenuity.</p>

</section>
<section id="events-in-javascript">
  <h2 id="s-events-in-javascript">Events in JavaScript</h2>

  <p>When talking about webpage design, whenever someone says something like “when
a user <em>does something</em>, we want <em>something to happen</em>,” they’re usually
talking about JavaScript. JavaScript and jQuery especially are very good at
handling these situations, which are called <strong>events</strong>. There are several such
events that jQuery recognizes, but we’ll stick to one important one,
<strong>click</strong>. The jQuery method associated with clicking, <code class="highlighter-rouge">$("").click()</code>, works
on any visible HTML element that gets selected by the jQuery selector, but we
want it to work on individual words that have modern glosses.</p>

  <p>Conceptually, this may be a bit tricky, so I’ll slow down and spell out the
steps here that we’ll follow:</p>

  <ol>
    <li>As things stand now, we have a single string getting printed to <code class="highlighter-rouge">#prologue</code>
that includes the first line of the Prologue.</li>
    <li>We want to break that line back up into individual word-<code class="highlighter-rouge">Object</code>s.</li>
    <li>If the word-<code class="highlighter-rouge">Object</code> has no <code class="highlighter-rouge">.modern</code> property, we print its <code class="highlighter-rouge">.text</code> property
as is.</li>
    <li>If it does, we want to surround the <code class="highlighter-rouge">.text</code> property in <code class="highlighter-rouge">&lt;a&gt;</code> tags, so that
it becomes a link.</li>
    <li>When we click on the link, we want the <code class="highlighter-rouge">.modern</code> property to get printed in
<code class="highlighter-rouge">#glosses</code>.</li>
  </ol>

  <p>The <em>real</em> final step, of course, will be to do this for all 18 lines, but let’s
stick to one line for now.</p>

  <p>The first step is straightforward. Remember, we are dealing with word-size
chunks of data to begin with, so you just have to get rid of that <code class="highlighter-rouge">.join()</code>
method and iterate over the array to build up the single line of text,
instead:</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">(</span><span class="s2">"#glosses"</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s2">"&lt;p&gt;The glosses will go here.&lt;/p&gt;"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">line1</span><span class="p">,</span> <span class="nx">line1Text</span><span class="p">;</span> <span class="c1">// don’t need the intermediate step of line1TextArray</span>
<span class="nx">line1</span> <span class="o">=</span> <span class="p">[{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"Whan"</span><span class="p">,</span> <span class="na">modern</span><span class="p">:</span> <span class="s2">"When"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"that"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"Aprill,"</span><span class="p">,</span>
        <span class="na">modern</span><span class="p">:</span> <span class="s2">"April,"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"with"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"his"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"shoures"</span><span class="p">,</span>
        <span class="na">modern</span><span class="p">:</span> <span class="s2">"showers"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"soote"</span><span class="p">,</span> <span class="na">modern</span><span class="p">:</span> <span class="s2">"sweet"</span><span class="p">}];</span>
<span class="c1">// Create a blank string that opens two tags.</span>
<span class="nx">line1Text</span> <span class="o">=</span> <span class="s2">"&lt;blockquote&gt;&lt;p&gt;"</span><span class="p">;</span>
<span class="nx">line1</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">word</span><span class="p">){</span>
  <span class="c1">// Add in the word-Object’s .text property plus a space.</span>
  <span class="nx">line1Text</span> <span class="o">=</span> <span class="nx">line1Text</span> <span class="o">+</span> <span class="nx">word</span><span class="p">.</span><span class="nx">text</span> <span class="o">+</span> <span class="s2">" "</span><span class="p">;</span>
<span class="p">});</span>
<span class="c1">// Break the line and close the two tags.</span>
<span class="nx">line1Text</span> <span class="o">=</span> <span class="nx">line1Text</span> <span class="o">+</span> <span class="s2">"&lt;br /&gt;(line 2 would go here)&lt;/p&gt;&lt;/blockquote&gt;"</span><span class="p">;</span>
<span class="nx">$</span><span class="p">(</span><span class="s2">"#prologue"</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">line1Text</span><span class="p">);</span>
</code></pre></div>  </div>

  <p>Nothing changes as far as the look of the webpage (if you save and reload),
but using that <code class="highlighter-rouge">.forEach()</code> method means that you expose the array to the
potential for an if statement. Looking just at that block:</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">line1</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">word</span><span class="p">){</span>
  <span class="c1">// Define a variable that will be the entirety of a single</span>
  <span class="c1">// word-sized chunk of information.</span>
  <span class="kd">let</span> <span class="nx">wordString</span><span class="p">;</span>
  <span class="nx">wordString</span> <span class="o">=</span> <span class="nx">word</span><span class="p">.</span><span class="nx">text</span><span class="p">;</span>
  <span class="c1">// Test to see if the .modern property exists.</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">word</span><span class="p">.</span><span class="nx">modern</span><span class="p">){</span>
    <span class="c1">// If it does, surround wordString in an &lt;a&gt; tag.</span>
    <span class="nx">wordString</span> <span class="o">=</span> <span class="s2">"&lt;a href='#'&gt;"</span> <span class="o">+</span> <span class="nx">wordString</span> <span class="o">+</span> <span class="s2">"&lt;/a&gt;"</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">// Add wordString plus a space to the line1Text.</span>
  <span class="nx">line1Text</span> <span class="o">=</span> <span class="nx">line1Text</span> <span class="o">+</span> <span class="nx">wordString</span> <span class="o">+</span> <span class="s2">" "</span><span class="p">;</span>
<span class="p">});</span>
</code></pre></div>  </div>

  <p>Save and reload. Now the words “Whan,” “Aprill,” “shoures,” and “soote” should
appear like links. If they do, commit. But if you click on them, nothing
happens. Here’s where the jQuery <code class="highlighter-rouge">.click()</code> method becomes our friend. At the
bottom of <code class="highlighter-rouge">prologue.js</code>, add:</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">(</span><span class="s2">"#prologue a"</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="nx">$</span><span class="p">(</span><span class="s2">"#glosses"</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s2">"&lt;h2&gt;You clicked on a word!&lt;/h2&gt;"</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>  </div>

  <p>The jQuery selector, <code class="highlighter-rouge">$("#prologue a")</code>, is selecting every <code class="highlighter-rouge">&lt;a&gt;</code> tag inside
<code class="highlighter-rouge">#prologue</code>. With the <code class="highlighter-rouge">click()</code> method, it says to execute a function whenever
the user clicks on an <code class="highlighter-rouge">&lt;a&gt;</code> tag inside <code class="highlighter-rouge">#prologue</code>. And that function appends
a string, “You clicked on a word!” to <code class="highlighter-rouge">#glosses</code>. Save, reload, and
start clicking on the words in the Prologue.</p>

  <p>We have one more step, which is to have the gloss be printed, not “You clicked
on a word.” But how can we tell jQuery what the value of a word-<code class="highlighter-rouge">Object</code>’s
<code class="highlighter-rouge">.modern</code> property is? This is tricky, so let’s break it up into two pieces:</p>

  <ol>
    <li>We want to send word-specific information to <code class="highlighter-rouge">#glosses</code>.</li>
    <li>We want that information to be the <code class="highlighter-rouge">.modern</code> property.</li>
  </ol>

  <p>Let’s just send the word <em>itself</em> to <code class="highlighter-rouge">#glosses</code>, to fulfill the first part of
this step. This requires making use of the <code class="highlighter-rouge">$( this )</code> selector we saw <a href="/v1/8-webpage">last
chapter</a> that lets a jQuery method get information about the
selected <code class="highlighter-rouge">Object</code>:</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">(</span><span class="s2">"#prologue a"</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="c1">// Define the text and the word that was clicked.</span>
  <span class="kd">let</span> <span class="nx">glossText</span><span class="p">,</span> <span class="nx">clickedWord</span><span class="p">;</span>
  <span class="nx">clickedWord</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span> <span class="k">this</span> <span class="p">).</span><span class="nx">text</span><span class="p">();</span>
  <span class="nx">glossText</span> <span class="o">=</span> <span class="s2">"&lt;h2&gt;You clicked on the word: "</span> <span class="o">+</span> <span class="nx">clickedWord</span> <span class="o">+</span> <span class="s2">"&lt;/h2&gt;"</span><span class="p">;</span>
  <span class="nx">$</span><span class="p">(</span><span class="s2">"#glosses"</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">glossText</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>  </div>

  <p>Save and reload. Note that the <code class="highlighter-rouge">.text()</code> method, when called without
parameters, <em>gets</em> the text. When called with parameters, it <em>sets</em> the text
to the parameter.  Unfortunately, we can’t do something like <code class="highlighter-rouge">$( this
).modern</code> to get the <code class="highlighter-rouge">.modern</code> property, though that would be pretty cool. Can
you see why?</p>

  <p>Instead, you have to feed the <code class="highlighter-rouge">&lt;a&gt;</code> tag some hidden data that you can then use
jQuery to harvest. Here, you should make use of <strong>data attributes</strong>, which are
custom, on-the-fly attributes you set in HTML. So make one, called
<code class="highlighter-rouge">data-modern</code>.<sup id="fnref:data-attributes"><a href="#fn:data-attributes" class="footnote">1</a></sup> Now change the <code class="highlighter-rouge">forEach</code> loop to add the
data-attribute:</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">line1</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">word</span><span class="p">){</span>
  <span class="kd">let</span> <span class="nx">wordString</span><span class="p">;</span>
  <span class="nx">wordString</span> <span class="o">=</span> <span class="nx">word</span><span class="p">.</span><span class="nx">text</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">word</span><span class="p">.</span><span class="nx">modern</span><span class="p">){</span>
    <span class="c1">// Add word.modern as a data attribute to the &lt;a&gt; tag.</span>
    <span class="nx">wordString</span> <span class="o">=</span> <span class="s2">"&lt;a href='#' data-modern='"</span> <span class="o">+</span> <span class="nx">word</span><span class="p">.</span><span class="nx">modern</span> <span class="o">+</span> <span class="s2">"'&gt;"</span> <span class="o">+</span> <span class="nx">wordString</span> <span class="o">+</span> <span class="s2">"&lt;/a&gt;"</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nx">line1Text</span> <span class="o">=</span> <span class="nx">line1Text</span> <span class="o">+</span> <span class="nx">wordString</span> <span class="o">+</span> <span class="s2">" "</span><span class="p">;</span>
<span class="p">});</span>
</code></pre></div>  </div>

  <p>Save and reload. To make sure it worked correctly, use the Element inspector
(a tab near the console tab in the browser’s developer tools) to see if the
HTML around the word “Whan” looks like this:</p>

  <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"#"</span> <span class="na">data-modern=</span><span class="s">"When"</span><span class="nt">&gt;</span>Whan<span class="nt">&lt;/a&gt;</span>
</code></pre></div>  </div>

  <p>There are a lot of places to mess this up above, which is why copying and
pasting chunks of code is sometimes a good idea. Of course, it’s also valuable
to have to find your mistakes. One possible mistake is forgetting that single
little <code class="highlighter-rouge">'</code> after <code class="highlighter-rouge">word.modern</code>. If everything looks good, go ahead and commit.</p>

  <p>And for the final piece of the final step, we need to get the information in
the <code class="highlighter-rouge">data-modern</code> attribute into jQuery. Easy. Just use the <code class="highlighter-rouge">$("").data()</code>
method:</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">(</span><span class="s2">"#prologue a"</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="kd">let</span> <span class="nx">glossText</span><span class="p">,</span> <span class="nx">clickedWord</span><span class="p">,</span> <span class="nx">modernWord</span><span class="p">;</span>
  <span class="nx">clickedWord</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span> <span class="k">this</span> <span class="p">).</span><span class="nx">text</span><span class="p">();</span>
  <span class="c1">// .data("modern") looks for the data-modern HTML attribute.</span>
  <span class="nx">modernWord</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span> <span class="k">this</span> <span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s2">"modern"</span><span class="p">);</span>
  <span class="nx">glossText</span> <span class="o">=</span> <span class="s2">"&lt;h2&gt;You clicked on "</span> <span class="o">+</span> <span class="nx">clickedWord</span> <span class="o">+</span> <span class="s2">", which means "</span> <span class="o">+</span> <span class="nx">modernWord</span> <span class="o">+</span><span class="s2">"&lt;/h2&gt;"</span><span class="p">;</span>
  <span class="nx">$</span><span class="p">(</span><span class="s2">"#glosses"</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">glossText</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>  </div>

  <p>Save and reload. If clicking on the words gives the modern word at the bottom,
then go ahead and commit. You’re done with this part of the chapter.</p>

</section>
<section id="json">
  <h2 id="s-json">JSON</h2>

  <p>You’ve done a lot in this chapter, but it’s remarkable how much builds on
the steps you already know. We’re not doing anything more complicated than
using arrays, <code class="highlighter-rouge">Object</code>s, and some fancier methods like <code class="highlighter-rouge">.data()</code>. There may be
conceptual hurdles, however, which is why it’s worthwhile to make sure you
understand how everything works above before we finish this chapter,
especially since one exercise requires you to expand on what we’ve built
together.</p>

  <p>Next, this might seem like a lot of work for just one line of Chaucer! And if
it were just the one line, I would agree. Luckily, it’s possible to load all
18 lines at once as one big JavaScript <code class="highlighter-rouge">Object</code>, so we can have the whole
first 18 lines of the General Prologue appear on our page.</p>

  <p><strong>JSON</strong> stands for “JavaScript Object Notation,” and it’s a way to transport
complex data using a syntax familiar to JavaScript. Concretely, that means
that a JSON <code class="highlighter-rouge">Object</code> is an <code class="highlighter-rouge">Object</code> that often has an array of other <code class="highlighter-rouge">Object</code>s
inside, which might have arrays or other <code class="highlighter-rouge">Object</code>s inside them. We can expand on
the data structure we already set for <code class="highlighter-rouge">line1</code> above, and imagine something
like this:</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">prologueObject</span><span class="p">;</span>
<span class="nx">prologueObject</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">lines</span><span class="p">:</span> <span class="p">[</span> <span class="c1">// .lines is an array of lines</span>
    <span class="p">[</span> <span class="c1">// this bracket opens the line 1 array, like above</span>
      <span class="p">{</span>
        <span class="na">text</span><span class="p">:</span> <span class="s2">"Whan"</span><span class="p">,</span>
        <span class="na">modern</span><span class="p">:</span> <span class="s2">"When"</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">text</span><span class="p">:</span> <span class="s2">"that"</span>
      <span class="p">}</span>
      <span class="c1">// ...</span>
    <span class="p">],</span> <span class="c1">// this closes the line 1 array</span>
    <span class="p">[</span> <span class="c1">// this opens the line 2 array</span>
      <span class="c1">// ...</span>
    <span class="p">]</span> <span class="c1">// closes line 2</span>
    <span class="c1">// ...</span>
  <span class="p">]</span> <span class="c1">// closes the .lines property</span>
<span class="p">}</span> <span class="c1">// closes prologueObject</span>
</code></pre></div>  </div>

  <p>As you can imagine, having to type that out would be a nightmare. Luckily,
I’ve already done it for you. Open up <a href="/v1/prologue.json">this file</a> in a new tab
and look at it. You can see that it looks like a regular JavaScript <code class="highlighter-rouge">Object</code>
except that the properties are strings, as well. That is, instead of <code class="highlighter-rouge">{text:
"that"}</code>, we get <code class="highlighter-rouge">{"text": "that"}</code>. Now we have to let <code class="highlighter-rouge">prologue.js</code> know
about this file.</p>

</section>
<section id="async">

  <h2 id="s-async">Async</h2>

  <p>Much of the work we do with JavaScript is <strong>asynchronous</strong>, or <strong>async</strong>, for
short. So far, all of our programming has been step-by-step. Do this, then do
that, then do this, then do that. But the real world doesn’t really work that
way, and the real world includes dealing with the internet. Maybe the server
that is hosting our JSON file is slow. Maybe the file is so huge it takes a
while to download it. Do we really want to wait while the whole file
downloads, leaving our webpage unresponsive?</p>

  <p>You already know I love burritos, but let’s think of this in terms of making
pasta. There are three big steps to making pasta: making the sauce, boiling
the pasta, and mixing them together. So let’s imagine a function:</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">makeAPastaDinner</span><span class="p">;</span>
<span class="nx">makeAPastaDinner</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span>
  <span class="nx">makeTheSauce</span><span class="p">();</span> <span class="c1">// includes chopping vegetables and simmering</span>
  <span class="nx">boilThePasta</span><span class="p">();</span> <span class="c1">// includes heating up the water</span>
  <span class="nx">mixTheSauceAndPasta</span><span class="p">();</span>
<span class="p">};</span>
</code></pre></div>  </div>

  <p>By the time we got to <code class="highlighter-rouge">mixTheSauceAndPasta()</code>, the sauce would be cold!
Imagine if we had to <em>finish</em> simmering the pasta sauce before we could start
on the pasta itself. Tragedy! Disaster! Worse, we could invert them, so that
we add cold, soggy pasta to sauce. Garbage!</p>

  <p>Instead, it’d be better if we could somehow write the function so that we can
start <code class="highlighter-rouge">makeTheSauce()</code> but, while it’s still happening (say, the sauce is
simmering), we start <code class="highlighter-rouge">boilThePasta()</code>.</p>

  <p>That’s cooking async. And we do stuff async constantly in our daily lives.
Software should be similar. In JavaScript, some functions and methods are
async, which means they do their thing while, in the meantime, the rest of
the functions happen. This asynchronous activity is done via <strong>callback
functions</strong>, which are functions that happen only once the calling function is
done. To continue with the pasta analogy, let’s get a bit more discrete:</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">makeAPastaDinner</span><span class="p">;</span>
<span class="nx">makeAPastaDinner</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(){</span>
  <span class="nx">prepareSauceIngredients</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span> <span class="c1">// This function is the callback</span>
    <span class="nx">simmerSauce</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>  <span class="c1">// another callback</span>
      <span class="nx">mixTheSauceAndPasta</span><span class="p">();</span>
    <span class="p">});</span>
    <span class="nx">boilThePasta</span><span class="p">();</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre></div>  </div>

  <p>The first step is <code class="highlighter-rouge">prepareSauceIngredients()</code>. When that finishes, it executes
its callback, which executes <code class="highlighter-rouge">simmerSauce()</code> <em>and</em> <code class="highlighter-rouge">boilThePasta()</code>, meaning
that the boiling and simmering are happening at the same time. Only once the
simmering is done does it call <em>its</em> callback, to <code class="highlighter-rouge">mixTheSauceAndPasta()</code>.</p>

  <p>In short, dealing with asynchronous functions means that sometimes the order
things are written in your JavaScript file are not the order in which they are
done. And jQuery’s method to get JSON <code class="highlighter-rouge">Object</code>s from the internet can be
confusing in its asynchronicity.</p>

</section>
<section id="finishing-the-prologue">

  <h2 id="s-finishing-up-by-combining-async-json-with-the-general-prologue">Finishing up by combining async JSON with the General Prologue.</h2>

  <p>Let’s make sure we’re all on the same page as we turn into this last quarter
lap. Your <code class="highlighter-rouge">prologue.js</code> file should look like this, more or less. I’ve taken
out the comments and added three new ones.</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1. Set the content of #glosses.</span>
<span class="nx">$</span><span class="p">(</span><span class="s2">"#glosses"</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s2">"&lt;p&gt;The glosses will go here.&lt;/p&gt;"</span><span class="p">);</span>
<span class="c1">// 2. Set the content of #prologue.</span>
<span class="kd">let</span> <span class="nx">line1</span><span class="p">,</span> <span class="nx">line1Text</span><span class="p">;</span>
<span class="nx">line1</span> <span class="o">=</span> <span class="p">[{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"Whan"</span><span class="p">,</span> <span class="na">modern</span><span class="p">:</span> <span class="s2">"When"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"that"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"Aprill,"</span><span class="p">,</span>
        <span class="na">modern</span><span class="p">:</span> <span class="s2">"April,"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"with"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"his"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"shoures"</span><span class="p">,</span>
        <span class="na">modern</span><span class="p">:</span> <span class="s2">"showers"</span><span class="p">},</span> <span class="p">{</span><span class="na">text</span><span class="p">:</span> <span class="s2">"soote"</span><span class="p">,</span> <span class="na">modern</span><span class="p">:</span> <span class="s2">"sweet"</span><span class="p">}];</span>
<span class="nx">line1Text</span> <span class="o">=</span> <span class="s2">"&lt;blockquote&gt;&lt;p&gt;"</span><span class="p">;</span>
<span class="nx">line1</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">word</span><span class="p">){</span>
  <span class="kd">let</span> <span class="nx">wordString</span><span class="p">;</span>
  <span class="nx">wordString</span> <span class="o">=</span> <span class="nx">word</span><span class="p">.</span><span class="nx">text</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">word</span><span class="p">.</span><span class="nx">modern</span><span class="p">){</span>
    <span class="nx">wordString</span> <span class="o">=</span> <span class="s2">"&lt;a href='#' data-modern='"</span> <span class="o">+</span> <span class="nx">word</span><span class="p">.</span><span class="nx">modern</span> <span class="o">+</span> <span class="s2">"'&gt;"</span> <span class="o">+</span> <span class="nx">wordString</span> <span class="o">+</span> <span class="s2">"&lt;/a&gt;"</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nx">line1Text</span> <span class="o">=</span> <span class="nx">line1Text</span> <span class="o">+</span> <span class="nx">wordString</span> <span class="o">+</span> <span class="s2">" "</span><span class="p">;</span>
<span class="p">});</span>
<span class="nx">line1Text</span> <span class="o">=</span> <span class="nx">line1Text</span> <span class="o">+</span> <span class="s2">"&lt;br /&gt;(line 2 would go here)&lt;/p&gt;&lt;/blockquote&gt;"</span><span class="p">;</span>
<span class="nx">$</span><span class="p">(</span><span class="s2">"#prologue"</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">line1Text</span><span class="p">);</span>
<span class="c1">// 3. Wait around for the user to click on an &lt;a&gt; tag inside #prologue</span>
<span class="c1">// and then change the content of #glosses.</span>
<span class="nx">$</span><span class="p">(</span><span class="s2">"#prologue a"</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="kd">let</span> <span class="nx">glossText</span><span class="p">,</span> <span class="nx">clickedWord</span><span class="p">,</span> <span class="nx">modernWord</span><span class="p">;</span>
  <span class="nx">clickedWord</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span> <span class="k">this</span> <span class="p">).</span><span class="nx">text</span><span class="p">();</span>
  <span class="nx">modernWord</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span> <span class="k">this</span> <span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s2">"modern"</span><span class="p">);</span>
  <span class="nx">glossText</span> <span class="o">=</span> <span class="s2">"&lt;h2&gt;You clicked on "</span> <span class="o">+</span> <span class="nx">clickedWord</span> <span class="o">+</span> <span class="s2">", which means "</span> <span class="o">+</span> <span class="nx">modernWord</span> <span class="o">+</span><span class="s2">"&lt;/h2&gt;"</span><span class="p">;</span>
  <span class="nx">$</span><span class="p">(</span><span class="s2">"#glosses"</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">glossText</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>  </div>

  <p>This works; it loads a line of text, and everything runs like we expect it to.
But I want to underscore the fact that this code is actually doing three big
things, as I’ve noted with the comments. Steps 1 and 3 stay the same. They
don’t care about the actual text of the Prologue. Step 1 only concerns
<code class="highlighter-rouge">#glosses</code>, and step 3 is just hanging out, waiting for the user to click. In
other words, the action will happen in step 2. Now, the jQuery method to get a
JSON file is <code class="highlighter-rouge">$.getJSON(file, callback)</code>, and it takes two parameters, as you
can see. The file part is easy, since you’ve been looking at it already:</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">.</span><span class="nx">getJSON</span><span class="p">(</span><span class="s2">"https://the-javascripting-english-major.org/v1/prologue.json"</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</code></pre></div>  </div>

  <p>The callback is a bit trickier, but let’s think it through abstractly:</p>

  <ol>
    <li>We have the JSON available to us as a variable for our callback called <code class="highlighter-rouge">data</code>.</li>
    <li>This <code class="highlighter-rouge">data</code> <code class="highlighter-rouge">Object</code> has a property, <code class="highlighter-rouge">.lines</code>, that is an array of lines.</li>
    <li>Each line in <code class="highlighter-rouge">.lines</code> is an array of word-<code class="highlighter-rouge">Object</code>s.</li>
    <li>Each word-<code class="highlighter-rouge">Object</code> has a <code class="highlighter-rouge">.text</code> property, and some have a <code class="highlighter-rouge">.modern</code> one.</li>
  </ol>

  <p>Then look to what you already have in that second step:</p>

  <ol>
    <li>It defines <code class="highlighter-rouge">line1</code>, an array of word-<code class="highlighter-rouge">Object</code>s, and <code class="highlighter-rouge">line1Text</code>, a blank string.</li>
    <li>It iterates over <code class="highlighter-rouge">line1</code> and builds up <code class="highlighter-rouge">line1Text</code> based on the properties of 
  the word-<code class="highlighter-rouge">Object</code>s.</li>
    <li>It closes the HTML tags in <code class="highlighter-rouge">line1Text</code>.</li>
    <li>It prints the value of <code class="highlighter-rouge">line1Text</code> in <code class="highlighter-rouge">#prologue</code>.</li>
  </ol>

  <p>Really all you need to do is two things: create a <code class="highlighter-rouge">prologueText</code> variable that
holds the text of the <em>whole</em> Prologue and repeat what you’ve already got down:</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span><span class="p">.</span><span class="nx">getJSON</span><span class="p">(</span><span class="s2">"https://the-javascripting-english-major.org/v1/prologue.json"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span> <span class="c1">// Note the data variable!</span>
  <span class="kd">let</span> <span class="nx">prologueText</span><span class="p">;</span> <span class="c1">// Define the variable you didn’t need before.</span>
  <span class="nx">prologueText</span> <span class="o">=</span> <span class="s2">"&lt;blockquote&gt;&lt;p&gt;"</span><span class="p">;</span> <span class="c1">// Open the tags.</span>
  <span class="c1">// Now you can iterate over the data variable’s .lines property:</span>
  <span class="nx">data</span><span class="p">.</span><span class="nx">lines</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">line</span><span class="p">){</span> <span class="c1">// We get a variable, line.</span>
    <span class="c1">// Define a blank lineText.</span>
    <span class="kd">let</span> <span class="nx">lineText</span><span class="p">;</span>
    <span class="nx">lineText</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
    <span class="c1">// Now iterate over each line. This part should be familiar.</span>
    <span class="nx">line</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">word</span><span class="p">){</span>
      <span class="kd">let</span> <span class="nx">wordString</span><span class="p">;</span>
      <span class="nx">wordString</span> <span class="o">=</span> <span class="nx">word</span><span class="p">.</span><span class="nx">text</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">word</span><span class="p">.</span><span class="nx">modern</span><span class="p">){</span>
        <span class="nx">wordString</span> <span class="o">=</span> <span class="s2">"&lt;a href='#' data-modern='"</span> <span class="o">+</span> <span class="nx">word</span><span class="p">.</span><span class="nx">modern</span> <span class="o">+</span> <span class="s2">"'&gt;"</span> <span class="o">+</span> <span class="nx">wordString</span> <span class="o">+</span> <span class="s2">"&lt;/a&gt;"</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">lineText</span> <span class="o">=</span> <span class="nx">lineText</span> <span class="o">+</span> <span class="nx">wordString</span> <span class="o">+</span> <span class="s2">" "</span><span class="p">;</span>
    <span class="p">});</span>
    <span class="c1">// Add lineText with a line break to the prologueText.</span>
    <span class="nx">prologueText</span> <span class="o">=</span> <span class="nx">prologueText</span> <span class="o">+</span> <span class="nx">lineText</span> <span class="o">+</span> <span class="s2">"&lt;br/&gt;"</span><span class="p">;</span>
  <span class="p">});</span>
  <span class="c1">// Close the prologueText tags.</span>
  <span class="nx">prologueText</span> <span class="o">=</span> <span class="nx">prologueText</span> <span class="o">+</span> <span class="s2">"&lt;/p&gt;&lt;/blockquote&gt;"</span><span class="p">;</span>
  <span class="c1">// Replace the content of #prologue.</span>
  <span class="nx">$</span><span class="p">(</span><span class="s2">"#prologue"</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">prologueText</span><span class="p">);</span>
<span class="p">});</span> <span class="c1">// Close the callback function &amp; method.</span>
</code></pre></div>  </div>

  <p>If you replace step two with this, save, and reload, huzzah! The first 18 lines
of the General Prologue appear. But if you click on the words, they don’t work
anymore. Nothing happens. That’s not fair! We didn’t even touch step 3. Why
did it work before, but not now?</p>

  <p>The answer is, you probably guessed, because of async. Think of the three
steps as three discrete functions:</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">setTheDefaultGlossesValue</span><span class="p">();</span>
<span class="nx">setTheDefaultPrologueValue</span><span class="p">();</span>
<span class="nx">selectThePrologueLinksAndWaitForClicks</span><span class="p">();</span>
</code></pre></div>  </div>

  <p>Because the second function runs asynchronously, the third function looks for
links in <code class="highlighter-rouge">#prologue</code>, but <em><code class="highlighter-rouge">#prologue</code> is still blank</em>. So by the time the
second function is done, the third has already finished its business. We need
to treat the third function as a callback to the second. We need to do
something like this:</p>

  <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">setTheDefaultGlossesValue</span><span class="p">();</span>
<span class="nx">setTheDefaultPrologueValue</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="nx">selectThePrologueLinksAndWaitForClicks</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div>  </div>

  <p>Figuring out how to do that is for homework. But here is
what the final page could look like: <a href="/v1/examples/prologue.html">prologue.html</a>.</p>
</section>
<section id="exercises">
  <h2 id="s-exercises">Exercises</h2>

  <ol>
    <li>Why can’t we simply do <code class="highlighter-rouge">$( this ).modern</code> to get the <code class="highlighter-rouge">.modern</code> property?</li>
    <li>Fix the problem with the Prologue and get the glosses to appear.</li>
    <li>I added a <code class="highlighter-rouge">"url"</code> property to the JSON file. Rewrite the code for the
Prologue so that the gloss also suggests taking you to Wikipedia if you
like.</li>
  </ol>

  <h2 id="s-foonotes">Foonotes</h2>

</section>
<div class="footnotes">
  <ol>
    <li id="fn:data-attributes">
      <p>Data attributes all begin with <code class="highlighter-rouge">data-</code>. <a href="#fnref:data-attributes" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

          <div class="row justify-content-between">
            <div class="">
            
              <a class="btn btn-info" href="/v1/8-webpage">
                Previous Chapter
              </a>
            
            </div>
            <div class="">
            
              <a class="btn btn-info" href="/v1/10-leaflet">
                Next Chapter
              </a>
            
            </div>
          </div>
        </article>
      </div>
    </div>
    <footer class="footer">
  <p>
    <small>© 2017, <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> by <a href="http://moacir.com" target="_blank">Moacir P. de Sá Pereira</a>.</small>
  </p>
</footer>

    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
<script src="/v1/assets/js/main.js"></script>


  </body>
